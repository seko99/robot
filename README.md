# Robot Control System

–ü—Ä–æ–µ–∫—Ç —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω—ã–º —Ä–æ–±–æ—Ç–æ–º —Å –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º –ø—Ä–∏–≤–æ–¥–æ–º –Ω–∞ –±–∞–∑–µ Arduino –∏ Orange Pi Zero 3.

## ü§ñ –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–±–æ—Ç–æ–º, —Å–æ—Å—Ç–æ—è—â–∞—è –∏–∑:
- **Arduino –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã** –¥–ª—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—Ç–æ—Ä–∞–º–∏ –∏ —Å–µ–Ω—Å–æ—Ä–∞–º–∏
- **Orange Pi Zero 3** –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä –¥–ª—è –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π –ª–æ–≥–∏–∫–∏
- **ROS2 –ø–∞–∫–µ—Ç—ã** –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤—ã–µ –¥–∞—Ç—á–∏–∫–∏** –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
- **–≠–Ω–∫–æ–¥–µ—Ä—ã** –¥–ª—è –æ–¥–æ–º–µ—Ç—Ä–∏–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
robot/
‚îú‚îÄ‚îÄ Motors/           # Arduino –∫–æ–¥ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–æ—Ç–æ—Ä–∞–º–∏
‚îú‚îÄ‚îÄ Sensors/          # Arduino –∫–æ–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç—á–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ ROS2/            # ROS2 –ø–∞–∫–µ—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–±–æ—Ç–æ–º
‚îú‚îÄ‚îÄ 3dprint/         # 3D –º–æ–¥–µ–ª–∏ –∫—Ä–µ–ø–ª–µ–Ω–∏–π –∏ –∫–æ—Ä–ø—É—Å–∞ (FreeCAD .FCStd)
‚îú‚îÄ‚îÄ docs/            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å—Ö–µ–º—ã (–ª–∏–¥–∞—Ä LDS01RR, Orange Pi Zero 3)
‚îú‚îÄ‚îÄ motor_test.py    # –°–∫—Ä–∏–ø—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ—Ç–æ—Ä–æ–≤
‚îú‚îÄ‚îÄ serial_read.py   # –£—Ç–∏–ª–∏—Ç–∞ —á—Ç–µ–Ω–∏—è Serial –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ compile.sh       # –°–∫—Ä–∏–ø—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –∑–∞–≥—Ä—É–∑–∫–∏
```

## üîß –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### Arduino –º–æ–¥—É–ª–∏

#### Motors (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ—Ç–æ—Ä–∞–º–∏)
- **–§–∞–π–ª**: `Motors/Motors.ino`
- **–§—É–Ω–∫—Ü–∏–∏**: 
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–≤—É–º—è DC –º–æ—Ç–æ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –¥—Ä–∞–π–≤–µ—Ä TB6612FNG
  - –ß—Ç–µ–Ω–∏–µ —ç–Ω–∫–æ–¥–µ—Ä–æ–≤ –¥–ª—è –æ–¥–æ–º–µ—Ç—Ä–∏–∏
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ Serial
- **–ü–∏–Ω—ã**:
  - –õ–µ–≤—ã–π –º–æ—Ç–æ—Ä: IN1=5, IN2=6, ENA=9
  - –ü—Ä–∞–≤—ã–π –º–æ—Ç–æ—Ä: IN3=7, IN4=8, ENB=10
  - –≠–Ω–∫–æ–¥–µ—Ä—ã: LEFT_H1=4, LEFT_H2=12, RIGHT_H1=2, RIGHT_H2=3

#### Sensors (–î–∞—Ç—á–∏–∫–∏)
- **–§–∞–π–ª**: `Sensors/Sensors.ino`
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –£–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –¥–∞—Ç—á–∏–∫ HC-SR04
  - –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è—Ö
- **–ü–∏–Ω—ã**:
  - TRIG=9, ECHO=10

### ROS2 –ø–∞–∫–µ—Ç—ã

–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ ROS2 –ø–∞–∫–µ—Ç—ã –¥–ª—è –∞–≤—Ç–æ–Ω–æ–º–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

#### üì¶ robot_bringup
–û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–æ–±–æ—Ç–∞

#### üì¶ robot_odometry  
–†–∞—Å—á–µ—Ç –æ–¥–æ–º–µ—Ç—Ä–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —ç–Ω–∫–æ–¥–µ—Ä–æ–≤

#### üì¶ robot_sonar
–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–≥–æ –¥–∞—Ç—á–∏–∫–∞

#### üì¶ robot_teleop
–¢–µ–ª–µ—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–±–æ—Ç–æ–º —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ ROS2 –ø–∞–∫–µ—Ç–æ–≤
```bash
cd ROS2/
./install_packages.sh
```

### –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã
```bash
# –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
./run_robot.sh full

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
./run_robot.sh keyboard

# –¢–æ–ª—å–∫–æ –æ–¥–æ–º–µ—Ç—Ä–∏—è
./run_robot.sh odometry
```

### –ö–æ–º–ø–∏–ª—è—Ü–∏—è Arduino –∫–æ–¥–∞
```bash
# –î–ª—è –º–æ—Ç–æ—Ä–æ–≤
cd Motors/
./compile.sh

# –î–ª—è –¥–∞—Ç—á–∏–∫–æ–≤  
cd Sensors/
./compile.sh
```

## üõ† –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Arduino
- **Motors Arduino**: –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ Orange Pi —á–µ—Ä–µ–∑ USB
- **Sensors Arduino**: –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ Orange Pi —á–µ—Ä–µ–∑ USB
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–æ—Ä—Ç—ã –≤ ROS2 –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–æ—Ç–æ—Ä–æ–≤
```
TB6612FNG –¥—Ä–∞–π–≤–µ—Ä:
- STBY -> Pin 11
- –õ–µ–≤—ã–π –º–æ—Ç–æ—Ä: AIN1->5, AIN2->6, PWMA->9  
- –ü—Ä–∞–≤—ã–π –º–æ—Ç–æ—Ä: BIN1->7, BIN2->8, PWMB->10
- –≠–Ω–∫–æ–¥–µ—Ä—ã: –ø–æ–¥–∫–ª—é—á–∏—Ç—å –∫ —Ü–∏—Ñ—Ä–æ–≤—ã–º –ø–∏–Ω–∞–º —Å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏
```

### –î–∞—Ç—á–∏–∫–∏
```
HC-SR04:
- VCC -> 5V
- GND -> GND  
- Trig -> Pin 9
- Echo -> Pin 10
```

## üì° –ü—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏

### –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ—Ç–æ—Ä–æ–≤
- `CMD_LEFT_FORWARD (0)` - –ª–µ–≤—ã–π –º–æ—Ç–æ—Ä –≤–ø–µ—Ä–µ–¥
- `CMD_LEFT_BACKWARD (1)` - –ª–µ–≤—ã–π –º–æ—Ç–æ—Ä –Ω–∞–∑–∞–¥
- `CMD_RIGHT_FORWARD (2)` - –ø—Ä–∞–≤—ã–π –º–æ—Ç–æ—Ä –≤–ø–µ—Ä–µ–¥
- `CMD_RIGHT_BACKWARD (3)` - –ø—Ä–∞–≤—ã–π –º–æ—Ç–æ—Ä –Ω–∞–∑–∞–¥
- `CMD_STOP_MOTORS (6)` - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –º–æ—Ç–æ—Ä–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
```cpp
struct Command {
  uint8_t cmd;
  uint8_t value;  // —Å–∫–æ—Ä–æ—Å—Ç—å 0-255
};

struct SensorData {
  uint32_t timestamp;
  float left_odometry;
  float right_odometry;
  // ... –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è
};
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç –º–æ—Ç–æ—Ä–æ–≤
```bash
python3 motor_test.py
```

### –ß—Ç–µ–Ω–∏–µ Serial –¥–∞–Ω–Ω—ã—Ö
```bash
python3 serial_read.py
```

### –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ROS2
```bash
cd ROS2/
./diagnose_packages.sh
```

### –¢–µ–ª–µ—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```bash
cd ~/ros2_ws/
source ~/ros2_ws/install/setup.bash
ros2 run teleop_twist_keyboard teleop_twist_keyboard
```

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ
- **Arduino IDE** –∏–ª–∏ **arduino-cli**
- **ROS2 Humble** (–Ω–∞ Orange Pi)
- **Python 3.8+**
- **pyserial** –¥–ª—è Python —Å–∫—Ä–∏–ø—Ç–æ–≤

### –ê–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ
- **Orange Pi Zero 3** (–æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä)
- **Arduino Uno/Nano** x2 (–º–æ—Ç–æ—Ä—ã –∏ –¥–∞—Ç—á–∏–∫–∏)
- **TB6612FNG** (–¥—Ä–∞–π–≤–µ—Ä –º–æ—Ç–æ—Ä–æ–≤)
- **HC-SR04** (—É–ª—å—Ç—Ä–∞–∑–≤—É–∫–æ–≤–æ–π –¥–∞—Ç—á–∏–∫)
- **DC –º–æ—Ç–æ—Ä—ã —Å —ç–Ω–∫–æ–¥–µ—Ä–∞–º–∏** x2
- **–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä** –∏ **DC-DC –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä**

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤
ls /dev/ttyUSB* /dev/ttyACM*

# –¢–µ—Å—Ç —Å–≤—è–∑–∏
python3 serial_read.py
```

### –õ–æ–≥–∏ ROS2
```bash
ros2 topic echo /odom
ros2 topic echo /sonar
```

## üìÑ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### 3D –º–æ–¥–µ–ª–∏ (`3dprint/`)
–í –ø–∞–ø–∫–µ —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è 3D –º–æ–¥–µ–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–æ–±–æ—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ **FreeCAD (.FCStd)**:
- –ö—Ä–µ–ø–ª–µ–Ω–∏—è –¥–ª—è –∑–∞—Ä—è–¥–Ω–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ö—Ä–µ–ø–ª–µ–Ω–∏—è –¥–ª—è DC-DC –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞
- –ö—Ä–µ–ø–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–≤–µ—Ä–±–∞–Ω–∫–∞
- –ö—Ä–µ–ø–ª–µ–Ω–∏—è –¥–ª—è –¥—Ä–∞–π–≤–µ—Ä–∞ –º–æ—Ç–æ—Ä–æ–≤ TB6612FNG
- –ö—Ä–µ–ø–ª–µ–Ω–∏—è –¥–ª—è –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
- –ö—Ä–µ–ø–ª–µ–Ω–∏—è –¥–ª—è –∫–æ–ª–µ—Å
- –ü–ª–∞—Å—Ç–∏–Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∏—Ç–∞–Ω–∏–µ–º
- –°—Ç–æ–π–∫–∏ 65–º–º

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (`docs/`)
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —Å—Ö–µ–º—ã:
- **–õ–∏–¥–∞—Ä LDS01RR**: datasheet, SDK, –ø—Ä–∏–º–µ—Ä—ã ROS –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Orange Pi Zero 3**: —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å—Ö–µ–º—ã
- –°—Ö–µ–º—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ —Å–±–æ—Ä–∫–∏

## ü§ù –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–∞–Ω–¥
–í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –±–∏–Ω–∞—Ä–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª —á–µ—Ä–µ–∑ Serial (115200 baud).

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–µ–Ω—Å–æ—Ä–æ–≤
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–¥ –≤ `Sensors/Sensors.ino`
2. –°–æ–∑–¥–∞—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π ROS2 –ø–∞–∫–µ—Ç
3. –û–±–Ω–æ–≤–∏—Ç—å launch —Ñ–∞–π–ª—ã

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
2. –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–æ–≤
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ diagnostic —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ROS2

---

**–ê–≤—Ç–æ—Ä**: seko  
**–î–∞—Ç–∞**: 2025  
**–õ–∏—Ü–µ–Ω–∑–∏—è**: MIT
